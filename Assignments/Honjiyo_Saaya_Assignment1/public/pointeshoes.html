<script src="/Assignments/Honjiyo_Saaya_Assignment1/product_data.js" type="text/javascript"> //pull data from product_data.js</script>        
<!DOCTYPE html>
<html lang="en">
    <script>
		let params = (new URL(document.location)).searchParams;
	window.onload = () =>  {
		if(params.has('purchase_submit')) {
			var quantities = JSON.parse(params.get('quantity'));
			for(i in quantities) {
				order_form[`quantity[${i}]`].value = quantities[i];
			}
		}
		
		//pop up error message
		if(params.has('errors')) {
			var errors = JSON.parse(params.get('errors')); 
			let err_str = '';
			for(err in  errors) {
				err_str += errors[err] + '\n';
			}
			alert(err_str);
		}
	}
//modified from Lab12
function isNonNegInt(q, return_errors = false) {
        errors = []; // assume no errors at first
        if (q == '') q = 0; // handle blank inputs as if they are 0
        if (Number(q) != q) errors.push('<font color="red">Not a number!</font>'); // Check if string is a number value
        else if (q > 10) errors.push('<font color="red">Only 10 in stock</font>');
        else if (q == 0) errors.push('<font color="red">Please select!</font>');
        else if (q < 0) errors.push('<font color="red">Negative value!</font>'); // Check if it is non-negative
        else if (parseInt(q) != q) errors.push('<font color="red">Not an integer!</font>'); // Check that it is an integer
        return return_errors ? errors : (errors.length == 0);
    }
	</script>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pointe Shoe Display</title>
    <link rel="stylesheet" href="./css/productdisplay.css">
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&display=swap" rel="stylesheet">
</head>

<body>
            <!-- Order Form -->
            <center>
                <h1>Order Here!</h1>
            </center>
            <form name="order_form" action="./process_form" method="POST"></form>
            <center>
                <p>Order your pointe shoes by entering a quantity in the textbox and press "Purchase" at the bottom of
                    the page! Be aware of the limited quantity.</p>
            </center>
            <!-- From SmartPhoneProducts WODs, modified formatting, displays products-->
                <main>
                    <form name="quantity_form" action="./process_form" method="post">
                    <div>                    
                        <script>
                        for(i=0; i < products.length; i++) {
                           document.write(`
                           <section class="item">
           <center><img src=${products[i].image}></center>
           <font color = "#6d6d5f"> <center><h2>${products[i].name}</h2></center></font>
           <center><p>$${products[i].price} ~ Quantity Available:${products[i].quantity}</p></center>
           <center><input type= "text" size="2" placeholder="0" name= "quantity_textbox${i}" <span id="quantity_textbox${i}_message"></span></center>
       </section>
       `);
                       }
                   </script>
               </main></div>

                <!-- Purchase button-->
                <center><input type="submit" class="button" value="Purchase" id="submit" name="purchase_submit"></center>
            </div>
            </form>
            </script>

</body>

</html>